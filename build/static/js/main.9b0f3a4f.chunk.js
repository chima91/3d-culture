(this["webpackJsonp3d-test_react"]=this["webpackJsonp3d-test_react"]||[]).push([[0],{150:function(e,t){},234:function(e,t){},236:function(e,t){},259:function(e,t,n){"use strict";n.r(t);var r,i,a,c,l,o,s,d,u,b,j,v,O,m,h,f,p,x,g,_,y,w,k,S,C=n(0),N=n.n(C),I=n(38),$=n.n(I),U=n(41),E=n(27),F=n(11),T=n(305),R=n(306),B=n(304),L=n(348),A=n(307),M=n(141),P=n.n(M),D=n(24),W=n(189),q=n(301),z=Object(q.a)({root:{maxWidth:"100%"}}),H=n(1),Q=function(){var e=z();return Object(H.jsx)(U.b,{to:"/",children:Object(H.jsx)("img",{className:e.root,src:"/static/logo.png",alt:"Culpticon"})})},V=n(205),G=n(349),J=Object(q.a)({root:{paddingLeft:10,display:"flex",alignItems:"center",maxWidth:700,flex:1,overflow:"hidden",marginLeft:10},input:{width:"100%"},searchIcon:{width:80,height:34,backgroundColor:"#E6E6E6",borderLeft:"1px solid #CCCCCC",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer","&:hover":{opacity:.72}}}),Z=Object(D.b)({key:"SearchWords",default:void 0}),K=function(){var e=J(),t=Object(C.useRef)(null),n=Object(D.c)(Z),r=Object(F.a)(n,2),i=r[0],a=r[1],c=Object(E.g)();return Object(H.jsxs)(V.a,{className:e.root,elevation:0,variant:"outlined",children:[Object(H.jsx)(G.a,{className:e.input,placeholder:"\u691c\u7d22\u30ef\u30fc\u30c9\u3092\u5165\u529b",inputRef:t,defaultValue:null===i||void 0===i?void 0:i.title}),Object(H.jsx)("div",{className:e.searchIcon,onClick:function(){var e,n=null===(e=t.current)||void 0===e?void 0:e.value;a(n?{title:n}:void 0),setTimeout((function(){return c("/")}),100)},children:Object(H.jsx)(B.a,{children:Object(H.jsx)(P.a,{})})})]})},X=Object(q.a)({between:{justifyContent:"space-between"},flex:{display:"flex"},logo:{width:150,marginLeft:10},profileIcon:{padding:0,width:44,height:44,marginLeft:10}}),Y=Object(D.b)({key:"GlobalUser",default:void 0}),ee=function(){var e=X(),t=(Object(D.d)(Y),Object(E.g)(),Object(C.useState)(null)),n=Object(F.a)(t,2),r=(n[0],n[1],Object(W.useMediaQuery)({minWidth:768})),i=Object(C.useState)(!1),a=Object(F.a)(i,2),c=a[0],l=a[1];return Object(H.jsx)(T.a,{color:"inherit",elevation:1,children:Object(H.jsxs)(R.a,{className:e.between,children:[Object(H.jsx)("div",{className:e.flex,children:Object(H.jsx)("div",{className:e.logo,children:Object(H.jsx)(Q,{})})}),r&&Object(H.jsx)(K,{}),!r&&Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(B.a,{onClick:function(){l(!0)},children:Object(H.jsx)(P.a,{})}),Object(H.jsx)(L.a,{fullWidth:!0,open:c,onClose:function(){l(!1)},"aria-labelledby":"responsive-dialog-title",children:Object(H.jsx)(A.a,{children:Object(H.jsx)(K,{})})})]})]})})},te=n(308),ne=n(309),re=n(310),ie=n(311),ae=n(190),ce=n.n(ae),le=n(191),oe=n.n(le),se=Object(q.a)({root:{backgroundColor:"#ffffff",minHeight:"100%"}}),de=function(){var e=se(),t=Object(D.d)(Y);return Object(H.jsxs)(te.a,{className:e.root,component:"nav",children:[Object(H.jsxs)(ne.a,{button:!0,component:U.b,to:"/",children:[Object(H.jsx)(re.a,{children:Object(H.jsx)(ce.a,{})}),Object(H.jsx)(ie.a,{primary:"\u30db\u30fc\u30e0"})]}),(null===t||void 0===t?void 0:t.id)&&Object(H.jsxs)(ne.a,{button:!0,component:U.b,to:"/channels",children:[Object(H.jsx)(re.a,{children:Object(H.jsx)(oe.a,{})}),Object(H.jsx)(ie.a,{primary:"\u767b\u9332\u30c1\u30e3\u30f3\u30cd\u30eb"})]})]})},ue=Object(q.a)({root:{display:"flex",minHeight:"100%"},sidebar:{paddingTop:64,width:240,"@media (max-width: 600px)":{display:"none"}},main:{paddingTop:94,flexGrow:1}}),be=function(){var e=ue();return Object(H.jsxs)("div",{className:e.root,children:[Object(H.jsx)(ee,{}),Object(H.jsx)("div",{className:e.sidebar,children:Object(H.jsx)(de,{})}),Object(H.jsx)("div",{className:e.main,children:Object(H.jsx)(E.b,{})})]})},je=Object(q.a)({root:{minHeight:"100%"},main:{paddingTop:94}}),ve=function(){var e=je();return Object(H.jsxs)("div",{className:e.root,children:[Object(H.jsx)(ee,{}),Object(H.jsx)("div",{className:e.main,children:Object(H.jsx)(E.b,{})})]})},Oe=Object(q.a)({root:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100%"}}),me=function(){var e=Oe();return Object(H.jsx)("div",{className:e.root,children:Object(H.jsx)(E.b,{})})},he=n(21),fe=n.n(he),pe=n(32),xe=n(332),ge=n(333),_e=n(350),ye=n(13),we=n(51),ke=n(341),Se=n(353),Ce=n(316),Ne=n(317),Ie={};!function(e){e.Id="id",e.Views="views"}(m||(m={})),function(e){e.ModelsPkey="models_pkey"}(h||(h={})),function(e){e.CreatedAt="created_at",e.Description="description",e.Id="id",e.ModelUrl="model_url",e.OwnerId="owner_id",e.ThumbnailUrl="thumbnail_url",e.Title="title",e.UpdatedAt="updated_at",e.Views="views"}(f||(f={})),function(e){e.CreatedAt="created_at",e.Description="description",e.Id="id",e.ModelUrl="model_url",e.OwnerId="owner_id",e.ThumbnailUrl="thumbnail_url",e.Title="title",e.UpdatedAt="updated_at",e.Views="views"}(p||(p={})),function(e){e.Asc="asc",e.AscNullsFirst="asc_nulls_first",e.AscNullsLast="asc_nulls_last",e.Desc="desc",e.DescNullsFirst="desc_nulls_first",e.DescNullsLast="desc_nulls_last"}(x||(x={})),function(e){e.SubscribersPkey="subscribers_pkey"}(g||(g={})),function(e){e.CreatedAt="created_at",e.SubscribeId="subscribe_id",e.UpdatedAt="updated_at",e.Userid="userid"}(_||(_={})),function(e){e.CreatedAt="created_at",e.SubscribeId="subscribe_id",e.UpdatedAt="updated_at",e.Userid="userid"}(y||(y={})),function(e){e.UsersPkey="users_pkey"}(w||(w={})),function(e){e.CreatedAt="created_at",e.Email="email",e.Id="id",e.Name="name",e.ProfilePhotoUrl="profile_photo_url",e.UpdatedAt="updated_at"}(k||(k={})),function(e){e.CreatedAt="created_at",e.Email="email",e.Id="id",e.Name="name",e.ProfilePhotoUrl="profile_photo_url",e.UpdatedAt="updated_at"}(S||(S={}));var $e=Object(ke.a)(r||(r=Object(we.a)(['\n    mutation InsertModel($id: String!, $title: String!, $description: String = "", $model_url: String!, $thumbnail_url: String!, $owner_id: String!) {\n  insert_models_one(\n    object: {id: $id, title: $title, description: $description, model_url: $model_url, thumbnail_url: $thumbnail_url, owner_id: $owner_id, views: 0}\n  ) {\n    id\n    description\n    created_at\n    model_url\n    owner_id\n    thumbnail_url\n    title\n    updated_at\n    views\n  }\n}\n    '])));Object(ke.a)(i||(i=Object(we.a)(['\n    mutation InsertUser($id: String!, $name: String!, $email: String!) {\n  insert_users_one(\n    object: {id: $id, name: $name, email: $email, profile_photo_url: ""}\n  ) {\n    id\n    name\n    email\n    profile_photo_url\n    created_at\n    updated_at\n  }\n}\n    '])));var Ue=Object(ke.a)(a||(a=Object(we.a)(["\n    mutation deleteSubscribe($subscribe_id: String!, $userid: String!) {\n  delete_subscribers_by_pk(subscribe_id: $subscribe_id, userid: $userid) {\n    userid\n    subscribe_id\n  }\n}\n    "])));var Ee=Object(ke.a)(c||(c=Object(we.a)(["\n    mutation InsertSubscribe($userid: String!, $subscribe_id: String!) {\n  insert_subscribers_one(object: {userid: $userid, subscribe_id: $subscribe_id}) {\n    userid\n    subscribe_id\n  }\n}\n    "])));var Fe=Object(ke.a)(l||(l=Object(we.a)(['\n    mutation updateModel($id: String!, $title: String!, $description: String = "", $model_url: String!, $thumbnail_url: String!) {\n  update_models_by_pk(\n    pk_columns: {id: $id}\n    _set: {title: $title, description: $description, model_url: $model_url, thumbnail_url: $thumbnail_url}\n  ) {\n    id\n    title\n    model_url\n    thumbnail_url\n    created_at\n    updated_at\n    owner {\n      id\n    }\n  }\n}\n    '])));var Te=Object(ke.a)(o||(o=Object(we.a)(["\n    mutation updateModelViews($modelId: String!) {\n  update_model_views(where: {id: {_eq: $modelId}}, _inc: {views: 1}) {\n    returning {\n      id\n      views\n    }\n  }\n}\n    "])));function Re(e){var t=Object(ye.a)(Object(ye.a)({},Ie),e);return Se.a(Te,t)}var Be=Object(ke.a)(s||(s=Object(we.a)(["\n    mutation updateUser($id: String!, $name: String!, $profile_photo_url: String) {\n  update_users_by_pk(\n    pk_columns: {id: $id}\n    _set: {name: $name, profile_photo_url: $profile_photo_url}\n  ) {\n    id\n    name\n    email\n    profile_photo_url\n    created_at\n    updated_at\n    subscribersByUserid {\n      subscribe_id\n    }\n  }\n}\n    "])));var Le=Object(ke.a)(d||(d=Object(we.a)(["\n    query ChannelList($id: String!) {\n  users_by_pk(id: $id) {\n    name\n    subscribersByUserid(order_by: {created_at: desc_nulls_last}) {\n      subscribed {\n        name\n        id\n        profile_photo_url\n        usersModelArrayRelation(order_by: {created_at: desc_nulls_last}, limit: 3) {\n          id\n          title\n          description\n          thumbnail_url\n          model_url\n          views\n          created_at\n          updated_at\n        }\n      }\n    }\n  }\n}\n    "])));var Ae=Object(ke.a)(u||(u=Object(we.a)(["\n    query ModelByPk($id: String!) {\n  models_by_pk(id: $id) {\n    id\n    description\n    title\n    thumbnail_url\n    model_url\n    views\n    created_at\n    updated_at\n    owner {\n      id\n      name\n      profile_photo_url\n      email\n      updated_at\n      created_at\n    }\n  }\n}\n    "])));function Me(e){var t=Object(ye.a)(Object(ye.a)({},Ie),e);return Ce.a(Ae,t)}var Pe=Object(ke.a)(b||(b=Object(we.a)(["\n    query Models {\n  models(order_by: {created_at: desc}) {\n    id\n    title\n    description\n    thumbnail_url\n    model_url\n    owner {\n      id\n      email\n      name\n      profile_photo_url\n      updated_at\n      created_at\n    }\n    views\n    updated_at\n    created_at\n  }\n}\n    "])));var De=Object(ke.a)(j||(j=Object(we.a)(["\n    query RecommendModels($currentModelId: String!) {\n  models(where: {id: {_neq: $currentModelId}}, order_by: {views: desc}) {\n    id\n    title\n    description\n    thumbnail_url\n    model_url\n    views\n    owner {\n      id\n      name\n      profile_photo_url\n      updated_at\n      email\n      created_at\n    }\n    created_at\n    updated_at\n  }\n}\n    "])));var We=Object(ke.a)(v||(v=Object(we.a)(["\n    query Subscribers($ownerid: String!) {\n  subscribers(where: {subscribe_id: {_eq: $ownerid}}) {\n    userid\n  }\n}\n    "])));var qe=Object(ke.a)(O||(O=Object(we.a)(["\n    query UserById($id: String!) {\n  users_by_pk(id: $id) {\n    id\n    name\n    email\n    profile_photo_url\n    created_at\n    updated_at\n    subscribersByUserid {\n      subscribe_id\n    }\n  }\n}\n    "])));var ze=function(){var e=function(e){var t=Object(ye.a)(Object(ye.a)({},Ie),e);return Se.a(Ee,t)}({refetchQueries:[qe,We]}),t=Object(F.a)(e,2),n=t[0],r=t[1],i=r.data,a=r.error;return{subscribe:function(){var e=Object(pe.a)(fe.a.mark((function e(t){var r,i;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.userid,i=t.subscribeId,!r||!i){e.next=11;break}return e.prev=2,e.next=5,n({variables:{userid:r,subscribe_id:i}});case 5:a&&console.log(a.message),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),new Error("\u30c1\u30e3\u30f3\u30cd\u30eb\u767b\u9332\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002");case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),data:i,error:a}},He=function(){var e=function(e){var t=Object(ye.a)(Object(ye.a)({},Ie),e);return Se.a(Ue,t)}({refetchQueries:[qe,We]}),t=Object(F.a)(e,2),n=t[0],r=t[1],i=r.data,a=r.error;return{unsubscribe:function(){var e=Object(pe.a)(fe.a.mark((function e(t){var r,i;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.userid,i=t.subscribeId,!r||!i){e.next=11;break}return e.prev=2,e.next=5,n({variables:{userid:r,subscribe_id:i}});case 5:a&&console.log(a.message),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),new Error("\u30c1\u30e3\u30f3\u30cd\u30eb\u767b\u9332\u306e\u89e3\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002");case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),data:i,error:a}},Qe=n(319),Ve=n(320),Ge=n(67),Je=n(321),Ze=n(322),Ke=n(323),Xe=n(197),Ye=n.n(Xe),et=n(148),tt=n.n(et),nt=n(35),rt=n(347),it=n(318),at=n(354),ct=n(344),lt=function(e){var t=e.glbSrc,n=rt.a(t).scene;return Object(H.jsxs)(nt.a,{children:[Object(H.jsx)(it.a,{makeDefault:!0,fov:60}),Object(H.jsx)(at.a,{enablePan:!0,enableZoom:!0,enableRotate:!0}),Object(H.jsx)(ct.a,{children:Object(H.jsx)("group",{dispose:null,children:Object(H.jsx)("primitive",{scale:[10,10,10],object:n})})})]})},ot=Object(q.a)({descPadding:{paddingLeft:56},canvas:{maxWidth:"1000px",height:"450px",backgroundColor:"#282828"},channelBtn:{display:"flex",marginLeft:15}}),st=function(e){var t=e.modelId,n=e.title,r=e.created,i=e.owner,a=e.avatar,c=e.description,l=e.views,o=e.subscribers,s=e.isCurrentModelByOthers,d=e.isCurrentModelByMine,u=e.isSubscribed,b=e.onSubscribe,j=e.onUnSubscribe,v=e.fetcher,O=ot(),m=Object(C.useState)(),h=Object(F.a)(m,2),f=h[0],p=h[1];return Object(C.useEffect)((function(){v().then(p)})),Object(H.jsxs)(Qe.a,{children:[Object(H.jsx)(Ve.a,{className:O.canvas,children:Object(H.jsx)(C.Suspense,{fallback:Object(H.jsx)("div",{style:{color:"white",textAlign:"center",marginTop:100},children:"Now Loading..."}),children:f?Object(H.jsx)(lt,{glbSrc:f}):Object(H.jsx)("p",{style:{color:"red",textAlign:"center",marginTop:100},children:"\u8868\u793a\u3067\u304d\u308b3D\u30e2\u30c7\u30eb\u304c\u3042\u308a\u307e\u305b\u3093\u3002"})})}),Object(H.jsxs)(Ve.a,{children:[Object(H.jsx)(Ge.a,{component:"h2",variant:"h4",children:n}),Object(H.jsx)(Ge.a,{variant:"body2",color:"textSecondary",children:r?new Date(r).toLocaleDateString():""}),Object(H.jsxs)(Ge.a,{variant:"body2",color:"textSecondary",children:["\u95b2\u89a7\u56de\u6570\uff1a",l,"\u56de"]})]}),Object(H.jsx)(Je.a,{}),Object(H.jsx)(Ze.a,{avatar:a,title:i,subheader:"\u30c1\u30e3\u30f3\u30cd\u30eb\u767b\u9332\u8005\u6570\uff1a".concat(o||0,"\u4eba")}),s&&Object(H.jsx)("div",{className:O.channelBtn,children:u?Object(H.jsx)(Ke.a,{variant:"contained",color:"default",onClick:j,startIcon:Object(H.jsx)(tt.a,{}),children:"\u30c1\u30e3\u30f3\u30cd\u30eb\u767b\u9332\u89e3\u9664"}):Object(H.jsx)(Ke.a,{variant:"contained",color:"primary",onClick:b,startIcon:Object(H.jsx)(Ye.a,{}),children:"\u30c1\u30e3\u30f3\u30cd\u30eb\u767b\u9332"})}),Object(H.jsx)(Ve.a,{className:O.descPadding,children:Object(H.jsx)(Ge.a,{children:c})}),d&&Object(H.jsx)(U.b,{to:"/detail/".concat(t,"/update"),style:{textDecoration:"none"},children:Object(H.jsx)(Ke.a,{variant:"contained",color:"primary",style:{margin:50},children:"\u7de8\u96c6\u3059\u308b"})})]})},dt=n(324),ut=Object(q.a)({root:{lineHeight:1.2}}),bt=function(e){var t=e.title,n=ut();return t.length>10&&(t=t.slice(0,10)+"..."),Object(H.jsx)(Ge.a,{className:n.root,variant:"subtitle1",component:"h3",children:t})},jt=function(e){var t=e.owner,n=e.created,r=e.views;return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(Ge.a,{variant:"body2",children:t}),Object(H.jsx)(Ge.a,{variant:"body2",children:n&&new Date(n).toLocaleDateString()}),Object(H.jsxs)(Ge.a,{variant:"body2",children:["\u95b2\u89a7\u56de\u6570\uff1a",r,"\u56de"]})]})},vt=Object(q.a)({root:{display:"flex",backgroundColor:"transparent"},thumbnail:{width:"50%"},media:{paddingTop:"56.25%"},contentPadding:{width:"50%",paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:10}}),Ot=function(e){var t=e.fetcher,n=e.title,r=e.owner,i=e.created,a=e.views,c=e.onClick,l=vt(),o=Object(C.useState)(),s=Object(F.a)(o,2),d=s[0],u=s[1];return Object(C.useEffect)((function(){t().then(u)})),n.length>10&&(n=n.slice(0,10)+"..."),Object(H.jsxs)(Qe.a,{className:l.root,elevation:0,square:!0,onClick:c,children:[Object(H.jsx)("div",{className:l.thumbnail,children:Object(H.jsx)(dt.a,{className:l.media,image:d||"/static/no-image.jpg",title:"Thumbnail"})}),Object(H.jsx)(Ze.a,{className:l.contentPadding,title:Object(H.jsx)(bt,{title:n}),subheader:Object(H.jsx)(jt,{owner:r,created:i,views:a})})]})},mt=n(325),ht=n(199),ft=n.n(ht),pt=n(198),xt=function(){var e=Object(pt.a)({text:window.location.href,options:{level:"M",margin:3,scale:1,width:200}}),t=Object(F.a)(e,1)[0];return Object(H.jsx)("canvas",{ref:t})},gt=function(){var e=Object(C.useState)(!1),t=Object(F.a)(e,2),n=t[0],r=t[1];return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(Ke.a,{onClick:function(){return r(!0)},variant:"outlined",color:"secondary",endIcon:Object(H.jsx)(ft.a,{}),style:{marginBottom:20},children:"QR\u30b3\u30fc\u30c9"}),Object(H.jsxs)(L.a,{onClose:function(){return r(!1)},open:n,children:[Object(H.jsx)(mt.a,{style:{textAlign:"center",padding:10,margin:0},children:"\u3053\u308c\u3067\u5e03\u6559\u3057\u3066\u304f\u3060\u3055\u3044m(._.)m"}),Object(H.jsx)(Je.a,{}),Object(H.jsx)(A.a,{children:Object(H.jsx)(xt,{})})]})]})},_t=n(326),yt=n(327),wt=n(328),kt=n(329),St=n(330),Ct=n(331),Nt=function(){return Object(H.jsxs)("span",{style:{marginLeft:15},children:[Object(H.jsx)(_t.a,{url:window.location.href,title:"\u300cCulpticon\u300d\u30673D\u306e\u6587\u5316\u8ca1\u3092\u697d\u3057\u3082\u3046!",style:{margin:5},children:Object(H.jsx)(yt.a,{size:32,round:!0})}),Object(H.jsx)(wt.a,{url:window.location.href,title:"\u300cCulpticon\u300d\u30673D\u306e\u6587\u5316\u8ca1\u3092\u697d\u3057\u3082\u3046!",style:{margin:5},children:Object(H.jsx)(kt.a,{size:32,round:!0})}),Object(H.jsx)(St.a,{url:window.location.href,quote:"\u300cCulpticon\u300d\u30673D\u306e\u6587\u5316\u8ca1\u3092\u697d\u3057\u3082\u3046!",style:{margin:5},children:Object(H.jsx)(Ct.a,{size:32,round:!0})})]})},It=Object(q.a)({root:{maxWidth:1400},cardPadding:{marginBottom:10}}),$t=n(110);n(256),n(260),n(261);$t.a.initializeApp({apiKey:"AIzaSyBcaCwPXi3F4a0uz3JGkMZNIy3i9PmVNS8",authDomain:"react-3d-f49c6.firebaseapp.com",projectId:"react-3d-f49c6",storageBucket:"react-3d-f49c6.appspot.com",messagingSenderId:"419875646774",appId:"1:419875646774:web:ab2657b7d6289c74d59797",measurementId:"G-GCMW5GDSDY"});var Ut=$t.a.auth(),Et=$t.a.storage(),Ft=($t.a.firestore(),$t.a,function(){var e,t,n,r,i,a,c,l,o,s,d,u,b,j,v,O,m=It(),h=Object(E.h)().objId,f=Me({variables:{id:h}}).data,p=function(e){var t=Object(ye.a)(Object(ye.a)({},Ie),e);return Ce.a(De,t)}({variables:{currentModelId:h}}).data,x=null===p||void 0===p?void 0:p.models.slice(0,6),g=Re({refetchQueries:[{query:Pe}]}),_=Object(F.a)(g,2),y=_[0],w=_[1].error,k=function(){var e=Object(pe.a)(fe.a.mark((function e(t){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y({variables:{modelId:t}});case 2:w&&console.log(w.message);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(e){var t=Object(ye.a)(Object(ye.a)({},Ie),e);return Ce.a(We,t)}({variables:{ownerid:(null===f||void 0===f||null===(e=f.models_by_pk)||void 0===e||null===(t=e.owner)||void 0===t?void 0:t.id)||""}}).data,C=ze(),N=C.subscribe,I=C.error,$=function(){var e=Object(pe.a)(fe.a.mark((function e(t,n){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N({userid:t,subscribeId:n});case 2:I&&console.log(I.message);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),T=He(),R=T.unsubscribe,B=T.error,L=function(){var e=Object(pe.a)(fe.a.mark((function e(t,n){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R({userid:t,subscribeId:n});case 2:B&&console.log(B.message);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),A=Object(D.d)(Y),M=1===(null===A||void 0===A||null===(n=A.subscribersByUserid)||void 0===n?void 0:n.filter((function(e){var t,n;return e.subscribe_id===(null===f||void 0===f||null===(t=f.models_by_pk)||void 0===t||null===(n=t.owner)||void 0===n?void 0:n.id)})).length),P=(null===A||void 0===A?void 0:A.id)&&A.id!==(null===f||void 0===f||null===(r=f.models_by_pk)||void 0===r||null===(i=r.owner)||void 0===i?void 0:i.id),W=(null===A||void 0===A?void 0:A.id)&&A.id===(null===f||void 0===f||null===(a=f.models_by_pk)||void 0===a||null===(c=a.owner)||void 0===c?void 0:c.id);return Object(H.jsxs)(xe.a,{className:m.root,children:[Object(H.jsx)(gt,{}),Object(H.jsx)(Nt,{}),Object(H.jsxs)(ge.a,{container:!0,spacing:4,children:[Object(H.jsx)(ge.a,{item:!0,xs:12,lg:8,children:Object(H.jsx)(st,{modelId:null===f||void 0===f||null===(l=f.models_by_pk)||void 0===l?void 0:l.id,title:null===f||void 0===f||null===(o=f.models_by_pk)||void 0===o?void 0:o.title,created:null===f||void 0===f||null===(s=f.models_by_pk)||void 0===s?void 0:s.created_at,owner:null===f||void 0===f||null===(d=f.models_by_pk)||void 0===d||null===(u=d.owner)||void 0===u?void 0:u.name,avatar:Object(H.jsx)(_e.a,{src:null===f||void 0===f||null===(b=f.models_by_pk)||void 0===b||null===(j=b.owner)||void 0===j?void 0:j.profile_photo_url}),description:null===f||void 0===f||null===(v=f.models_by_pk)||void 0===v?void 0:v.description,views:null===f||void 0===f||null===(O=f.models_by_pk)||void 0===O?void 0:O.views,subscribers:(null===S||void 0===S?void 0:S.subscribers.length)||0,isCurrentModelByOthers:P||!1,isCurrentModelByMine:W||!1,isSubscribed:M,fetcher:Object(pe.a)(fe.a.mark((function e(){var t;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===f||void 0===f||null===(t=f.models_by_pk)||void 0===t?void 0:t.model_url)){e.next=2;break}return e.abrupt("return",Et.ref(f.models_by_pk.model_url).getDownloadURL());case 2:return e.abrupt("return",void 0);case 3:case"end":return e.stop()}}),e)}))),onSubscribe:function(){var e,t;$((null===A||void 0===A?void 0:A.id)||"",(null===f||void 0===f||null===(e=f.models_by_pk)||void 0===e||null===(t=e.owner)||void 0===t?void 0:t.id)||"")},onUnSubscribe:function(){var e,t;L((null===A||void 0===A?void 0:A.id)||"",(null===f||void 0===f||null===(e=f.models_by_pk)||void 0===e||null===(t=e.owner)||void 0===t?void 0:t.id)||"")}})}),Object(H.jsx)(ge.a,{item:!0,xs:12,lg:4,children:null===x||void 0===x?void 0:x.map((function(e){var t;return Object(H.jsx)("div",{className:m.cardPadding,children:Object(H.jsx)(U.b,{to:"/detail/".concat(e.id),style:{textDecoration:"none"},children:Object(H.jsx)(Ot,{title:e.title,owner:(null===(t=e.owner)||void 0===t?void 0:t.name)||"",created:e.created_at,views:e.views,fetcher:function(){return Et.ref(e.thumbnail_url).getDownloadURL()},onClick:function(){return k(e.id)}})})},e.id)}))})]})]})}),Tt=Object(q.a)({root:{maxWidth:360,backgroundColor:"transparent"},media:{height:0,paddingTop:"56.25%"}}),Rt=function(e){var t=e.fetcher,n=e.onClick,r=e.avatar,i=e.title,a=e.owner,c=e.created,l=e.views,o=Tt(),s=Object(C.useState)(),d=Object(F.a)(s,2),u=d[0],b=d[1];return Object(C.useEffect)((function(){t().then(b)})),Object(H.jsxs)(Qe.a,{onClick:n,children:[Object(H.jsx)(dt.a,{className:o.media,image:u||"/static/no-image.jpg",title:"Thumbnail"}),Object(H.jsx)(Ze.a,{avatar:r,title:Object(H.jsx)(bt,{title:i}),subheader:Object(H.jsx)(jt,{owner:a,created:c,views:l})})]})},Bt=n(343),Lt=Object(q.a)({stack:{backgroundColor:"transparent",width:"100%",padding:"1rem",textAlign:"center"},pagination:{display:"inline-block"}}),At=function(e){var t=e.totalPage,n=e.currentPage,r=e.handleChange,i=Lt();return Object(H.jsx)("div",{className:i.stack,children:Object(H.jsx)(Bt.a,{count:t,page:n,onChange:function(e,t){return r(t)},className:i.pagination})})},Mt=function(){var e=function(e){var t=Object(ye.a)(Object(ye.a)({},Ie),e);return Ce.a(Pe,t)}(),t=e.data,n=e.error;Object(C.useEffect)((function(){n&&console.error(n)}),[n]);var r=Object(D.d)(Z),i=r&&t?t.models.filter((function(e){var t;return null===(t=e.title)||void 0===t?void 0:t.match(r.title||"")})):null===t||void 0===t?void 0:t.models,a=Object(C.useState)(1),c=Object(F.a)(a,2),l=c[0],o=c[1],s=Object(C.useState)(0),d=Object(F.a)(s,2),u=d[0],b=d[1],j=Math.floor((((null===i||void 0===i?void 0:i.length)||0)-1)/8)+1,v=null===i||void 0===i?void 0:i.slice(u,u+8),O=Re({refetchQueries:[{query:Pe}]}),m=Object(F.a)(O,2),h=m[0],f=m[1].error,p=function(){var e=Object(pe.a)(fe.a.mark((function e(t){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h({variables:{modelId:t}});case 2:f&&console.log(f.message);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(xe.a,{children:[Object(H.jsx)(gt,{}),Object(H.jsx)(Nt,{}),Object(H.jsxs)(ge.a,{container:!0,spacing:2,children:[!(null===v||void 0===v?void 0:v.length)&&Object(H.jsx)("p",{children:"\u8a72\u5f53\u3059\u308b\u30e2\u30c7\u30eb\u304c\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002"}),null===v||void 0===v?void 0:v.map((function(e){var t,n;return Object(H.jsx)(ge.a,{item:!0,xs:12,md:6,lg:3,children:Object(H.jsx)(U.b,{to:"/detail/".concat(e.id),style:{textDecoration:"none"},children:Object(H.jsx)(Rt,{title:e.title,owner:(null===(t=e.owner)||void 0===t?void 0:t.name)||"",created:e.created_at,views:e.views,fetcher:function(){return Et.ref(e.thumbnail_url||"").getDownloadURL()},onClick:function(){return p(e.id)},avatar:Object(H.jsx)(_e.a,{src:(null===(n=e.owner)||void 0===n?void 0:n.profile_photo_url)||""})})})},e.id)}))]}),Object(H.jsx)(At,{totalPage:j,currentPage:l,handleChange:function(e){return function(e){o(e),b(8*(e-1))}(e)}})]})},Pt=n(334),Dt=n(335),Wt=n(105),qt=n.n(Wt),zt=n(339),Ht=n(346),Qt=function(){var e=Object(C.useState)(!1),t=Object(F.a)(e,2),n=t[0],r=t[1],i=Object(C.useState)(),a=Object(F.a)(i,2),c=a[0],l=a[1],o=function(e){var t=Object(ye.a)(Object(ye.a)({},Ie),e);return Se.a($e,t)}({refetchQueries:[{query:Pe}]}),s=Object(F.a)(o,2),d=s[0],u=s[1].error,b=Object(D.d)(Y),j=function(e,t,n){var r=t.name.split(".").pop();return Et.ref("".concat(n,"/").concat(e,".").concat(r)).put(t)},v=function(){var e=Object(pe.a)(fe.a.mark((function e(t){var n,i,a,c,o,s,u,v,O,m,h;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file,i=t.title,a=t.description,c=t.ownerId,null===b||void 0===b?void 0:b.id){e.next=3;break}return e.abrupt("return");case 3:return r(!0),o=Object(Ht.a)(),s=Object(Ht.a)(),u=Object(Ht.a)(),e.prev=7,e.next=10,j(o,n.model,"models");case 10:return O=e.sent,e.next=13,j(s,n.thumbnail,"thumbnails");case 13:return m=e.sent,e.next=16,d({variables:{id:u,title:i,description:a,model_url:O.ref.fullPath,thumbnail_url:m.ref.fullPath,owner_id:c}});case 16:return h=e.sent,e.abrupt("return",null===(v=h.data)||void 0===v?void 0:v.insert_models_one);case 20:e.prev=20,e.t0=e.catch(7),console.error(e.t0),l(new Error("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002"));case 24:return e.prev=24,r(!1),e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[7,20,24,27]])})));return function(t){return e.apply(this,arguments)}}();return Object(C.useEffect)((function(){u&&(console.error(u),l(new Error("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002")))}),[u]),{upload:v,loading:n,error:c}},Vt=Object(q.a)({label:{display:"block",paddingBottom:40},button:{display:"flex",justifyContent:"center"}}),Gt=function(e){var t=e.modelFile,n=e.thumbFile,r=Vt(),i=Object(E.g)(),a=Object(D.d)(Y),c=Object(C.useRef)(null),l=Object(C.useRef)(null),o=Object(C.useState)(),s=Object(F.a)(o,2),d=s[0],u=s[1],b=Qt(),j=b.upload,v=b.loading,O=b.error;return Object(C.useEffect)((function(){u(O)}),[O]),Object(H.jsxs)(H.Fragment,{children:[Object(H.jsxs)("label",{className:r.label,children:[Object(H.jsx)(Ge.a,{variant:"body2",children:"\u30bf\u30a4\u30c8\u30eb"}),Object(H.jsx)(zt.a,{size:"small",fullWidth:!0,variant:"outlined",inputRef:c})]}),Object(H.jsxs)("label",{className:r.label,children:[Object(H.jsx)(Ge.a,{variant:"body2",children:"\u8aac\u660e"}),Object(H.jsx)(zt.a,{size:"small",fullWidth:!0,variant:"outlined",multiline:!0,rows:4,inputRef:l})]}),(null===d||void 0===d?void 0:d.message)&&Object(H.jsx)("label",{className:r.label,children:Object(H.jsx)(Ge.a,{color:"error",children:d.message})}),Object(H.jsx)("div",{className:r.button,children:Object(H.jsx)(Ke.a,{variant:"contained",color:"primary",disabled:v,onClick:function(){var e,r;return u(void 0),(null===a||void 0===a?void 0:a.id)?t&&n?t.name.match(".glb$")?(null===(e=c.current)||void 0===e?void 0:e.value)?void j({file:{model:t,thumbnail:n},title:c.current.value,description:null===(r=l.current)||void 0===r?void 0:r.value,ownerId:a.id}).then((function(e){(null===e||void 0===e?void 0:e.id)&&i("/")})):u(new Error("\u30bf\u30a4\u30c8\u30eb\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002")):u(new Error("\u30e2\u30c7\u30eb\u30d5\u30a1\u30a4\u30eb\u306f\u3001.glb\u5f62\u5f0f\u306e\u3082\u306e\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002")):u(new Error("\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002")):u(new Error("\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044\u3002"))},children:v?"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u4e2d":"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b"})})]})},Jt=Object(q.a)({root:{minHeight:300},textPadding:{paddingTop:20,paddingBottom:10},button:{textAlign:"center",margin:"30px 0"},thumbnail:{paddingTop:"56.25%"}}),Zt=function(e){var t=e.modelFile,n=e.thumbFile,r=e.setModelFile,i=e.setThumbFile,a=Jt(),c=Object(C.useState)(),l=Object(F.a)(c,2),o=l[0],s=l[1],d=Object(C.useState)(),u=Object(F.a)(d,2),b=u[0],j=u[1],v=Object(C.useRef)(null),O=Object(C.useRef)(null);return Object(C.useEffect)((function(){if(t){var e=URL.createObjectURL(t);s(e)}}),[t]),Object(C.useEffect)((function(){if(n){var e=URL.createObjectURL(n);j(e)}}),[n]),Object(H.jsxs)("div",{className:a.root,children:[o&&Object(H.jsx)("div",{children:Object(H.jsxs)(Ge.a,{className:a.textPadding,children:["\u30e2\u30c7\u30eb\u30d5\u30a1\u30a4\u30eb\uff1a",null===t||void 0===t?void 0:t.name]})}),Object(H.jsx)("div",{className:a.button,children:Object(H.jsx)(Ke.a,{variant:"contained",color:"primary",onClick:function(){var e;null===(e=v.current)||void 0===e||e.click()},children:"\u30e2\u30c7\u30eb\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e"})}),Object(H.jsx)(Je.a,{}),b&&Object(H.jsxs)("div",{children:[Object(H.jsxs)(Ge.a,{className:a.textPadding,children:["\u30b5\u30e0\u30cd\u30a4\u30eb\u30d5\u30a1\u30a4\u30eb\uff1a",null===n||void 0===n?void 0:n.name]}),Object(H.jsx)(dt.a,{className:a.thumbnail,image:b})]}),Object(H.jsx)("div",{className:a.button,children:Object(H.jsx)(Ke.a,{variant:"contained",color:"primary",onClick:function(){var e;null===(e=O.current)||void 0===e||e.click()},children:"\u30b5\u30e0\u30cd\u30a4\u30eb\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e"})}),Object(H.jsx)("input",{type:"file",hidden:!0,ref:v,onChange:function(e){var t;(null===(t=e.currentTarget.files)||void 0===t?void 0:t.length)&&r(e.currentTarget.files[0])}}),Object(H.jsx)("input",{type:"file",hidden:!0,ref:O,onChange:function(e){var t;(null===(t=e.currentTarget.files)||void 0===t?void 0:t.length)&&i(e.currentTarget.files[0])}})]})},Kt=Object(q.a)({body:{marginTop:40,marginBottom:40},closeButton:{position:"absolute",right:"1rem",top:"0.5rem",color:"gray"}}),Xt=Object(D.b)({key:"AccountLoaded",default:!1}),Yt=function(){var e=Kt(),t=Object(D.d)(Xt),n=Object(D.d)(Y),r=Object(C.useState)(),i=Object(F.a)(r,2),a=i[0],c=i[1],l=Object(C.useState)(),o=Object(F.a)(l,2),s=o[0],d=o[1],u=Object(E.g)(),b=Object(C.useState)(!0),j=Object(F.a)(b,2)[1];return console.log("accountLoaded(Upload page):",t),console.log("globalUser(Upload page):",n),Object(C.useEffect)((function(){t&&((null===n||void 0===n?void 0:n.id)||u("/login"))}),[t,null===n||void 0===n?void 0:n.id]),Object(H.jsxs)(L.a,{fullWidth:!0,maxWidth:"md",open:!0,children:[Object(H.jsxs)(Pt.a,{children:["3D\u30e2\u30c7\u30eb\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9",Object(H.jsx)(B.a,{className:e.closeButton,onClick:function(){j(!1),u("/")},children:Object(H.jsx)(qt.a,{})})]}),Object(H.jsx)(Je.a,{}),Object(H.jsx)(A.a,{className:e.body,children:(null===n||void 0===n?void 0:n.id)?Object(H.jsxs)(ge.a,{container:!0,spacing:4,children:[Object(H.jsx)(ge.a,{xs:!0,item:!0,children:Object(H.jsx)(Zt,{modelFile:a,thumbFile:s,setModelFile:c,setThumbFile:d})}),Object(H.jsx)(Je.a,{orientation:"vertical",flexItem:!0}),Object(H.jsx)(ge.a,{xs:!0,item:!0,children:Object(H.jsx)(Gt,{modelFile:a,thumbFile:s})})]}):Object(H.jsx)(ge.a,{container:!0,justifyContent:"center",children:Object(H.jsx)(Dt.a,{size:50})})})]})},en=function(){var e=Object(C.useState)(!1),t=Object(F.a)(e,2),n=t[0],r=t[1],i=Object(C.useState)(),a=Object(F.a)(i,2),c=a[0],l=a[1],o=function(e){var t=Object(ye.a)(Object(ye.a)({},Ie),e);return Se.a(Fe,t)}({refetchQueries:[{query:Pe}]}),s=Object(F.a)(o,2),d=s[0],u=s[1].error,b=Object(D.d)(Y),j=function(e,t,n){var r=t.name.split(".").pop();return Et.ref("".concat(n,"/").concat(e,".").concat(r)).put(t)},v=function(){var e=Object(pe.a)(fe.a.mark((function e(t){var n,i,a,c,o,s,u,v,O,m;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.modelId,i=t.file,a=t.title,c=t.description,null===b||void 0===b?void 0:b.id){e.next=3;break}return e.abrupt("return");case 3:return r(!0),o=Object(Ht.a)(),s=Object(Ht.a)(),e.prev=6,e.next=9,j(o,i.model,"models");case 9:return v=e.sent,e.next=12,j(s,i.thumbnail,"thumbnails");case 12:return O=e.sent,e.next=15,d({variables:{id:n,title:a,description:c,model_url:v.ref.fullPath,thumbnail_url:O.ref.fullPath}});case 15:return m=e.sent,e.abrupt("return",null===(u=m.data)||void 0===u?void 0:u.update_models_by_pk);case 19:e.prev=19,e.t0=e.catch(6),console.error(e.t0),l(new Error("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002"));case 23:return e.prev=23,r(!1),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[6,19,23,26]])})));return function(t){return e.apply(this,arguments)}}();return Object(C.useEffect)((function(){u&&(console.error(u),l(new Error("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002")))}),[u]),{upload:v,loading:n,error:c}},tn=Object(q.a)({label:{display:"block",paddingBottom:40},button:{display:"flex",justifyContent:"center"}}),nn=function(e){var t,n,r=e.modelFile,i=e.thumbFile,a=tn(),c=Object(E.h)().objId,l=Me({variables:{id:c}}).data,o=Object(E.g)(),s=Object(D.d)(Y),d=Object(C.useRef)(null),u=Object(C.useRef)(null),b=Object(C.useState)(),j=Object(F.a)(b,2),v=j[0],O=j[1],m=en(),h=m.upload,f=m.loading,p=m.error;return Object(C.useEffect)((function(){O(p)}),[p]),Object(H.jsxs)(H.Fragment,{children:[Object(H.jsxs)("label",{className:a.label,children:[Object(H.jsx)(Ge.a,{variant:"body2",children:"\u30bf\u30a4\u30c8\u30eb"}),Object(H.jsx)(zt.a,{size:"small",fullWidth:!0,variant:"outlined",inputRef:d,defaultValue:null===l||void 0===l||null===(t=l.models_by_pk)||void 0===t?void 0:t.title})]}),Object(H.jsxs)("label",{className:a.label,children:[Object(H.jsx)(Ge.a,{variant:"body2",children:"\u8aac\u660e"}),Object(H.jsx)(zt.a,{size:"small",fullWidth:!0,variant:"outlined",multiline:!0,rows:4,inputRef:u,defaultValue:null===l||void 0===l||null===(n=l.models_by_pk)||void 0===n?void 0:n.description})]}),(null===v||void 0===v?void 0:v.message)&&Object(H.jsx)("label",{className:a.label,children:Object(H.jsx)(Ge.a,{color:"error",children:v.message})}),Object(H.jsx)("div",{className:a.button,children:Object(H.jsx)(Ke.a,{variant:"contained",color:"primary",disabled:f,onClick:function(){var e,t,n;return O(void 0),(null===s||void 0===s?void 0:s.id)?r&&i?(null===(e=d.current)||void 0===e?void 0:e.value)?void h({modelId:null===l||void 0===l||null===(t=l.models_by_pk)||void 0===t?void 0:t.id,file:{model:r,thumbnail:i},title:d.current.value,description:null===(n=u.current)||void 0===n?void 0:n.value}).then((function(e){(null===e||void 0===e?void 0:e.id)&&o("/detail/".concat(c))})):O(new Error("\u30bf\u30a4\u30c8\u30eb\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002")):O(new Error("\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002")):O(new Error("\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044\u3002"))},children:f?"\u66f4\u65b0\u4e2d":"\u66f4\u65b0\u3059\u308b"})})]})},rn=Object(q.a)({root:{minHeight:300},textPadding:{paddingTop:20,paddingBottom:10},button:{textAlign:"center",margin:"30px 0"},thumbnail:{paddingTop:"56.25%"}}),an=function(e){var t=e.currentModelUrl,n=e.currentThumbUrl,r=e.modelFile,i=e.thumbFile,a=e.setModelFile,c=e.setThumbFile,l=rn(),o=Object(C.useState)(t||""),s=Object(F.a)(o,2),d=s[0],u=s[1],b=Object(C.useState)(n||""),j=Object(F.a)(b,2),v=j[0],O=j[1],m=Object(C.useRef)(null),h=Object(C.useRef)(null);return Object(C.useEffect)((function(){if(r){var e=URL.createObjectURL(r);u(e)}}),[r]),Object(C.useEffect)((function(){if(i){var e=URL.createObjectURL(i);O(e)}}),[i]),Object(H.jsxs)("div",{className:l.root,children:[d&&Object(H.jsx)("div",{children:Object(H.jsxs)(Ge.a,{className:l.textPadding,children:["\u30e2\u30c7\u30eb\u30d5\u30a1\u30a4\u30eb\uff1a",null===r||void 0===r?void 0:r.name]})}),Object(H.jsx)("div",{className:l.button,children:Object(H.jsx)(Ke.a,{variant:"contained",color:"primary",onClick:function(){var e;null===(e=m.current)||void 0===e||e.click()},children:"\u30e2\u30c7\u30eb\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e"})}),Object(H.jsx)(Je.a,{}),v&&Object(H.jsxs)("div",{children:[Object(H.jsxs)(Ge.a,{className:l.textPadding,children:["\u30b5\u30e0\u30cd\u30a4\u30eb\u30d5\u30a1\u30a4\u30eb\uff1a",null===i||void 0===i?void 0:i.name]}),Object(H.jsx)(dt.a,{className:l.thumbnail,image:v})]}),Object(H.jsx)("div",{className:l.button,children:Object(H.jsx)(Ke.a,{variant:"contained",color:"primary",onClick:function(){var e;null===(e=h.current)||void 0===e||e.click()},children:"\u30b5\u30e0\u30cd\u30a4\u30eb\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e"})}),Object(H.jsx)("input",{type:"file",hidden:!0,ref:m,onChange:function(e){var t;(null===(t=e.currentTarget.files)||void 0===t?void 0:t.length)&&a(e.currentTarget.files[0])}}),Object(H.jsx)("input",{type:"file",hidden:!0,ref:h,onChange:function(e){var t;(null===(t=e.currentTarget.files)||void 0===t?void 0:t.length)&&c(e.currentTarget.files[0])}})]})},cn=Object(q.a)({body:{marginTop:40,marginBottom:40}}),ln=function(){var e,t,n=cn(),r=Object(D.d)(Xt),i=Object(D.d)(Y),a=Object(C.useState)(),c=Object(F.a)(a,2),l=c[0],o=c[1],s=Object(C.useState)(),d=Object(F.a)(s,2),u=d[0],b=d[1],j=Object(E.g)(),v=Object(C.useState)(!0),O=Object(F.a)(v,2)[1];console.log("accountLoaded(ModelUpdate page):",r),console.log("globalUser(ModelUpdate page):",i),Object(C.useEffect)((function(){r&&((null===i||void 0===i?void 0:i.id)||j("/login"))}),[r,null===i||void 0===i?void 0:i.id]);var m=Me({variables:{id:Object(E.h)().objId}}).data;return Object(H.jsxs)(L.a,{fullWidth:!0,maxWidth:"md",open:!0,children:[Object(H.jsxs)(Pt.a,{children:["3D\u30e2\u30c7\u30eb\u306e\u66f4\u65b0",Object(H.jsx)(B.a,{onClick:function(){O(!1),j("/")},children:Object(H.jsx)(qt.a,{})})]}),Object(H.jsx)(Je.a,{}),Object(H.jsx)(A.a,{className:n.body,children:(null===i||void 0===i?void 0:i.id)?Object(H.jsxs)(ge.a,{container:!0,spacing:4,children:[Object(H.jsx)(ge.a,{xs:!0,item:!0,children:Object(H.jsx)(an,{currentModelUrl:null===m||void 0===m||null===(e=m.models_by_pk)||void 0===e?void 0:e.model_url,currentThumbUrl:null===m||void 0===m||null===(t=m.models_by_pk)||void 0===t?void 0:t.thumbnail_url,modelFile:l,thumbFile:u,setModelFile:o,setThumbFile:b})}),Object(H.jsx)(Je.a,{orientation:"vertical",flexItem:!0}),Object(H.jsx)(ge.a,{xs:!0,item:!0,children:Object(H.jsx)(nn,{modelFile:l,thumbFile:u})})]}):Object(H.jsx)(ge.a,{container:!0,justifyContent:"center",children:Object(H.jsx)(Dt.a,{size:50})})})]})},on=Object(q.a)({card:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:10,padding:10},cardHeader:{width:240},unsubButton:{marginTop:10,marginLeft:10}}),sn=function(){var e,t=on(),n=Object(D.d)(Y),r=function(e){var t=Object(ye.a)(Object(ye.a)({},Ie),e);return Ce.a(Le,t)}({variables:{id:(null===n||void 0===n?void 0:n.id)||""}}),i=r.data,a=r.error,c=He(),l=c.unsubscribe,o=c.error,s=function(){var e=Object(pe.a)(fe.a.mark((function e(t,n){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({userid:t,subscribeId:n});case 2:o&&console.log(o.message);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),d=Re({refetchQueries:[{query:Pe}]}),u=Object(F.a)(d,2),b=u[0],j=u[1].error,v=function(){var e=Object(pe.a)(fe.a.mark((function e(t){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b({variables:{modelId:t}});case 2:j&&console.log(j.message);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(C.useEffect)((function(){a&&console.error(a)}),[a]),Object(H.jsx)(xe.a,{children:Object(H.jsx)(H.Fragment,{children:null===i||void 0===i||null===(e=i.users_by_pk)||void 0===e?void 0:e.subscribersByUserid.map((function(e){return Object(H.jsx)("div",{children:Object(H.jsxs)(Qe.a,{className:t.card,children:[Object(H.jsxs)("div",{children:[Object(H.jsx)(Ze.a,{className:t.cardHeader,avatar:Object(H.jsx)(_e.a,{src:e.subscribed.profile_photo_url||""}),title:e.subscribed.name}),Object(H.jsx)(Ke.a,{variant:"contained",color:"default",startIcon:Object(H.jsx)(tt.a,{}),onClick:function(){return s((null===n||void 0===n?void 0:n.id)||"",e.subscribed.id)},className:t.unsubButton,children:"\u767b\u9332\u89e3\u9664"})]}),Object(H.jsx)(ge.a,{container:!0,spacing:2,children:e.subscribed.usersModelArrayRelation.map((function(e){return Object(H.jsx)(ge.a,{item:!0,xs:3,children:Object(H.jsx)(U.b,{to:"/detail/".concat(e.id),style:{textDecoration:"none"},children:Object(H.jsx)(Rt,{title:e.title,views:e.views,created:e.created_at,fetcher:function(){return Et.ref(e.thumbnail_url).getDownloadURL()},onClick:function(){return v(e.id)}})})},e.id)}))})]})},e.subscribed.id)}))})})},dn=Object(q.a)({root:{display:"flex",flexDirection:"column",minHeight:300,justifyContent:"center",alignItems:"center"},textPadding:{paddingTop:20,paddingBottom:10},avatarFigure:{width:300,height:300,borderRadius:"100%",margin:"auto"},full:{width:"100%"},button:{marginTop:"2rem"}}),un=function(e){var t=e.currentAvatarUrl,n=e.avatarFile,r=e.setAvatarFile,i=dn(),a=Object(C.useState)(t||""),c=Object(F.a)(a,2),l=c[0],o=c[1],s=Object(C.useRef)(null);return Object(C.useEffect)((function(){if(n){var e=URL.createObjectURL(n);o(e)}}),[n]),Object(H.jsxs)("div",{className:i.root,children:[l&&Object(H.jsx)("div",{className:i.full,children:Object(H.jsx)(dt.a,{component:"img",src:l||"",className:i.avatarFigure})}),Object(H.jsxs)("div",{className:i.button,children:[Object(H.jsx)("input",{type:"file",hidden:!0,ref:s,onChange:function(e){var t;(null===(t=e.currentTarget.files)||void 0===t?void 0:t.length)&&r(e.currentTarget.files[0])}}),Object(H.jsx)(Ke.a,{variant:"contained",color:"primary",onClick:function(){var e;null===(e=s.current)||void 0===e||e.click()},children:"\u753b\u50cf\u3092\u9078\u629e"})]})]})},bn=function(){var e=Object(C.useState)(!1),t=Object(F.a)(e,2),n=t[0],r=t[1],i=Object(C.useState)(),a=Object(F.a)(i,2),c=a[0],l=a[1],o=function(e){var t=Object(ye.a)(Object(ye.a)({},Ie),e);return Se.a(Be,t)}({refetchQueries:[{query:qe}]}),s=Object(F.a)(o,2),d=s[0],u=s[1].error,b=Object(D.d)(Y),j=function(e,t,n){if(t){var r=t.name.split(".").pop();return Et.ref("".concat(n,"/").concat(e,".").concat(r)).put(t)}return null},v=function(){var e=Object(pe.a)(fe.a.mark((function e(t){var n,i,a,c,o,s,u,v;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file,i=t.name,t.description,a=t.userId,null===b||void 0===b?void 0:b.id){e.next=3;break}return e.abrupt("return");case 3:return r(!0),c=b.id,e.prev=5,e.next=8,j(c,n.avatar,"avatars");case 8:if(s=e.sent,u="",!s){e.next=16;break}return e.next=13,s.ref.getDownloadURL();case 13:u=e.sent,e.next=17;break;case 16:u=b.profile_photo_url||"";case 17:return e.next=19,d({variables:{id:a,name:i,profile_photo_url:u}});case 19:return v=e.sent,e.abrupt("return",null===(o=v.data)||void 0===o?void 0:o.update_users_by_pk);case 23:e.prev=23,e.t0=e.catch(5),console.error(e.t0),l(new Error("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002"));case 27:return e.prev=27,r(!1),e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[5,23,27,30]])})));return function(t){return e.apply(this,arguments)}}();return Object(C.useEffect)((function(){u&&(console.error(u),l(new Error("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002")))}),[u]),{loading:n,error:c,upload:v}},jn=Object(q.a)({label:{display:"block",paddingBottom:40},button:{display:"flex",justifyContent:"center"}}),vn=function(e){var t=e.avatarFile,n=jn(),r=Object(D.d)(Y),i=Object(C.useRef)(null),a=Object(C.useRef)(null),c=Object(C.useState)(),l=Object(F.a)(c,2),o=l[0],s=l[1],d=bn(),u=d.upload,b=d.loading,j=d.error;return Object(C.useEffect)((function(){s(j)}),[j]),Object(H.jsxs)(H.Fragment,{children:[Object(H.jsxs)("label",{className:n.label,children:[Object(H.jsx)(Ge.a,{variant:"body2",children:"\u540d\u524d"}),Object(H.jsx)(zt.a,{size:"small",fullWidth:!0,variant:"outlined",inputRef:i,defaultValue:null===r||void 0===r?void 0:r.name})]}),Object(H.jsxs)("label",{className:n.label,children:[Object(H.jsx)(Ge.a,{variant:"body2",children:"\u8fd1\u6cc1"}),Object(H.jsx)(zt.a,{size:"small",fullWidth:!0,multiline:!0,rows:4,variant:"outlined",inputRef:a})]}),(null===o||void 0===o?void 0:o.message)&&Object(H.jsx)("label",{className:n.label,children:Object(H.jsx)(Ge.a,{color:"error",children:o.message})}),Object(H.jsx)("div",{className:n.button,children:Object(H.jsx)(Ke.a,{variant:"contained",color:"primary",disabled:b,onClick:function(){var e,n;return s(void 0),(null===r||void 0===r?void 0:r.id)?(null===(e=i.current)||void 0===e?void 0:e.value)?void u({file:{avatar:t},name:i.current.value,description:null===(n=a.current)||void 0===n?void 0:n.value,userId:r.id}):s(new Error("\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044")):s(new Error("\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044\u3002"))},children:b?"\u66f4\u65b0\u4e2d":"\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u66f4\u65b0"})})]})},On=Object(q.a)({body:{marginTop:40,marginBottom:40},closeButton:{position:"absolute",right:"1rem",top:"0.5rem",color:"gray"}}),mn=function(){var e=On(),t=Object(D.d)(Xt),n=Object(D.d)(Y),r=Object(C.useState)(),i=Object(F.a)(r,2),a=i[0],c=i[1],l=Object(E.g)();Object(C.useEffect)((function(){t&&((null===n||void 0===n?void 0:n.id)||l("/login"))}),[t,null===n||void 0===n?void 0:n.id]);var o=Object(C.useState)(!0),s=Object(F.a)(o,2),d=s[0],u=s[1],b=function(){u(!1),l("/")};return Object(H.jsxs)(L.a,{fullWidth:!0,maxWidth:"md",open:d,onClose:b,children:[Object(H.jsxs)(Pt.a,{children:["\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb",Object(H.jsx)(B.a,{className:e.closeButton,onClick:b,children:Object(H.jsx)(qt.a,{})})]}),Object(H.jsx)(Je.a,{}),Object(H.jsx)(A.a,{className:e.body,children:(null===n||void 0===n?void 0:n.id)?Object(H.jsxs)(ge.a,{container:!0,spacing:4,children:[Object(H.jsx)(ge.a,{xs:!0,item:!0,children:Object(H.jsx)(un,{currentAvatarUrl:n.profile_photo_url||void 0,avatarFile:a,setAvatarFile:c})}),Object(H.jsx)(Je.a,{orientation:"vertical",flexItem:!0}),Object(H.jsx)(ge.a,{xs:!0,item:!0,children:Object(H.jsx)(vn,{avatarFile:a})})]}):Object(H.jsx)(ge.a,{container:!0,justifyContent:"center",children:Object(H.jsx)(Dt.a,{size:50})})})]})},hn=Object(q.a)({root:{width:"95%",maxWidth:600,padding:"50px 70px"},margin:{marginBottom:40},logo:{width:150}}),fn=function(){var e=hn();return Object(H.jsxs)(Qe.a,{className:e.root,variant:"outlined",children:[Object(H.jsx)("div",{className:"".concat(e.logo," ").concat(e.margin),children:Object(H.jsx)(Q,{})}),Object(H.jsx)(Ge.a,{className:e.margin,component:"h1",variant:"h5",children:"\u304a\u63a2\u3057\u306e\u30da\u30fc\u30b8\u306f\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002"}),Object(H.jsx)("div",{children:Object(H.jsx)(Ke.a,{href:"/",color:"primary",children:"\u30c8\u30c3\u30d7\u30da\u30fc\u30b8\u3078\u623b\u308b"})})]})},pn=function(){return Object(E.j)([{element:Object(H.jsx)(be,{}),children:[{path:"/",element:Object(H.jsx)(Mt,{})},{path:"upload",element:Object(H.jsx)(Yt,{})},{path:"profile",element:Object(H.jsx)(mn,{})},{path:"channels",element:Object(H.jsx)(sn,{})}]},{element:Object(H.jsx)(ve,{}),children:[{path:"detail",element:Object(H.jsx)(E.a,{to:"/"})},{path:"detail/:objId",element:Object(H.jsx)(Ft,{})},{path:"detail/:objId/update",element:Object(H.jsx)(ln,{})}]},{element:Object(H.jsx)(me,{}),children:[{path:"404",element:Object(H.jsx)(fn,{})}]},{path:"*",element:Object(H.jsx)(E.a,{to:"/404"})}])},xn=n(202),gn=n(337),_n=n(338),yn=n(262),wn=Object(yn.a)({"@global":{html:{width:"100%",height:"100%"},body:{width:"100%",height:"100%"},"#root":{width:"100%",height:"100%"},img:{display:"block",maxWidth:"100%"}}})((function(){return null})),kn=Object(D.b)({key:"AuthCredential",default:void 0}),Sn=Object(D.b)({key:"AuthCredentialLoaded",default:!1}),Cn=function(e){var t=e.children,n=Object(D.e)(kn),r=Object(D.e)(Sn);return Object(C.useEffect)((function(){return Ut.onAuthStateChanged(function(){var e=Object(pe.a)(fe.a.mark((function e(t){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n((null===t||void 0===t?void 0:t.uid)||void 0),r(!0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),Object(H.jsx)(H.Fragment,{children:t})},Nn=function(e){var t=e.children,n=function(e){var t=Object(ye.a)(Object(ye.a)({},Ie),e);return Ne.a(qe,t)}(),r=Object(F.a)(n,2),i=r[0],a=r[1],c=a.data,l=a.error,o=a.loading,s=Object(D.c)(Y),d=Object(F.a)(s,2),u=d[0],b=d[1],j=Object(D.d)(kn),v=Object(D.d)(Sn),O=Object(D.e)(Xt);return Object(C.useEffect)((function(){v&&(j?o||(null===u||void 0===u?void 0:u.id)||(O(!1),i({variables:{id:j}})):(null===u||void 0===u?void 0:u.id)&&b(void 0))}),[j,v]),Object(C.useEffect)((function(){var e;v&&!o&&((null===c||void 0===c||null===(e=c.users_by_pk)||void 0===e?void 0:e.id)&&j?b(c.users_by_pk):(null===u||void 0===u?void 0:u.id)&&b(void 0),O(!0))}),[v,c]),Object(C.useEffect)((function(){(null===l||void 0===l?void 0:l.message)&&(console.error(null===l||void 0===l?void 0:l.message),b(void 0))}),[l]),Object(H.jsx)(H.Fragment,{children:t})},In=n(203),$n=n(340),Un=n(342),En=n(336),Fn=n(201),Tn=Object(In.a)({uri:"https://react-3d.hasura.app/v1/graphql"}),Rn=Object(Fn.a)(Object(pe.a)(fe.a.mark((function e(){var t,n,r;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=Ut.currentUser)||void 0===t?void 0:t.getIdToken(!0);case 2:return n=e.sent,r=n?{Authorization:"Bearer ".concat(n)}:{},e.abrupt("return",{headers:r});case 5:case"end":return e.stop()}}),e)})))),Bn=new $n.a({link:Rn.concat(Tn),cache:new Un.a}),Ln=function(e){var t=e.children;return Object(H.jsx)(En.a,{client:Bn,children:t})},An=Object(xn.a)();$.a.render(Object(H.jsx)(N.a.StrictMode,{children:Object(H.jsx)(D.a,{children:Object(H.jsx)(gn.a,{theme:An,children:Object(H.jsx)(Ln,{children:Object(H.jsx)(Cn,{children:Object(H.jsx)(Nn,{children:Object(H.jsxs)(U.a,{children:[Object(H.jsx)(_n.a,{}),Object(H.jsx)(wn,{}),Object(H.jsx)(pn,{})]})})})})})})}),document.getElementById("root"))}},[[259,1,2]]]);
//# sourceMappingURL=main.9b0f3a4f.chunk.js.map